<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- DO NOT EDIT: file automatically generated by ucampas from
     /Users/graemejenkinson/cheri-website/cam/soaap/workflow-b.html -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta content="text/html; charset=UTF-8" http-equiv="Content-Type" /><meta content="text/css" http-equiv="Content-Style-Type" /><title>Workflow</title><link rel="stylesheet" type="text/css" media="all" href="https://www.cl.cam.ac.uk/style/layout.css" /><link rel="stylesheet" type="text/css" media="print" href="https://www.cl.cam.ac.uk/style/print.css" /><link href="https://www.cl.cam.ac.uk/style/blue.css" media="all" rel="stylesheet" type="text/css" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="soaap.css" rel="stylesheet" type="text/css" /><link href="annotations.html" rel="Next" /><link href="." rel="Up" /></head><body class="two-col dept">
<div id="skip"> <a href="#skip-content" accesskey="2">Skip to content</a>&#160;|&#160;<a href="https://www.cam.ac.uk/site/accesskeys.html" accesskey="0">Access key help</a> </div><div id="header">
  <div id="branding"><a href="https://www.cam.ac.uk/" accesskey="1"><img src="https://www.cl.cam.ac.uk/images/identifier.svg" alt="University of Cambridge" class="ucam" /></a>
  </div>

    <div id="site-search">

    <form action="http://web-search.cam.ac.uk/query.html" method="get">
      <fieldset>
      <label for="search-term">Search</label>
      <input name="qt" type="text" id="search-term" accesskey="4" value="" />
      <input id="search-button" src="https://www.cl.cam.ac.uk/images/button-search.gif" value="Search" alt="Search" title="Search" type="image" />
      </fieldset>
    </form>

    </div>
</div>

<div id="dept-title">
<h1><a href="../"></a></h1></div>

<div id="container"> <a name="skip-content" id="skip-content"></a>
<ul id="nav-breadcrumb"></ul><ul id="nav-primary"><li><div><a href="../">CTSRD&#160;&#187;</a></div></li><li><div><a href="../news.html">Project news</a></div></li><li><div><a href="../beri/">Bluespec Extensible RISC Implementation (BERI)&#160;&#187;</a></div></li><li><div><a href="../../capsicum/">Capsicum&#160;&#8594;</a></div></li><li><div><a href="../cheri/">Capability Hardware Enhanced RISC Instructions (CHERI)&#160;&#187;</a></div></li><li><div><a href=".">Security-Oriented Analysis of Application Programs (SOAAP)&#160;&#187;</a></div><ul><li><div><a href="build.html">Getting started</a></div></li><li class="active"><div><a href="workflow.html">Workflow</a></div></li><li><div><a href="annotations.html">Annotations</a></div></li><li><div><a href="flags.html">Command-line flags</a></div></li></ul></li><li><div><a href="../tesla/">Temporally Enhanced Security Logic Assertions (TESLA)&#160;&#187;</a></div></li><li><div><a href="../smten.html">Enhancing the Satisfiability Modulo Theories Experience (Smten)</a></div></li><li><div><a href="../publications.html">Publications</a></div></li><li><div><a href="../data/">Open Data&#160;&#187;</a></div></li><li><div><a href="../posters-slides.html">Posters and slides</a></div></li><li><div><a href="../people.html">Project members</a></div></li><li><div><a href="../related.html">Related</a></div></li></ul><div id="content"><div id="sub-brand"><p class="section">SOAAP</p></div><div id="content-primary">
<h1>Generating LLVM IR</h1>

<p>To run SOAAP on a program, you must first compile all the C/C++ files to LLVM IR and if there are several files, link them together into a single LLVM IR file. To compile to LLVM IR, use the following command:<br />
</p><pre>
[me@mymachine ~/workspace/scratch]$ clang -cc1 -g -I ~/workspace/me/soaap/include -emit-llvm file1.c file2.c file3.c
[me@mymachine ~/workspace/scratch]$ llvm-link -o myprog.ll file1.ll file2.ll file3.ll
</pre>

<p>This produces the LLVM IR file myprog.ll by linking the individual LLVM IR files.</p>

<h1>Running SOAAP</h1>

<p>We can now run the SOAAP tool on myprog.ll as follows:</p>

<pre>
[me@mymachine ~/workspace/scratch]$ ~/workspace/soaap/build/bin/soaap -o myprog.soaap myprog.ll
</pre>

<p>If you specified any performance simulation annotations, then SOAAP will have inserted instrumentation appropriately into the output file myprog.soaap. To perform the simulation, you need to create an executable and run it:</p>

<pre>
[me@mymachine ~/workspace/scratch]$ llc -filetype=obj -o myprog.o myprog.soaap
[me@mymachine ~/workspace/scratch]$ clang -o myprog-soaap myprog.o
[me@mymachine ~/workspace/scratch]$ ./myprog-soaap
soaap_perf_tic [215] SANDBOXED FUNCTION PROLOGUE -- TIC!
soaap_perf_enter_datain_persistent_sbox [59] Emulating performance of using persistent sandbox.
soaap_perf_enter_datain_persistent_sbox [103] DATALEN: 16
soaap_perf_enter_datain_persistent_sbox [122] PARENT: written to the pipe 16 bytes
soaap_perf_overhead_toc [222] SANDBOXED FUNCTION OVERHEAD -- SBOX_TOC!
Result: 16
[!!!] Sandboxing Overhead 69.998658% (Threshold: 12%)
soaap_perf_total_toc_thres [303] [Total Execution Time]: 22349 ns, [Sandboxing Time]: 15644 ns, [Sandboxing Overhead]: 69.998658%
</pre>

</div></div><ul id="site-info"><li class="copy">&#169; 2014-2016 Khilan Gudka<br />Information provided by <a href="/~kg365/">Khilan Gudka</a></li></ul></div>
</body></html>